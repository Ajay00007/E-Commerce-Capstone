{"ast":null,"code":"import _regeneratorRuntime from\"/home/andre/Documents/GithubRepos/Group_06/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _toConsumableArray from\"/home/andre/Documents/GithubRepos/Group_06/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _objectSpread from\"/home/andre/Documents/GithubRepos/Group_06/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _asyncToGenerator from\"/home/andre/Documents/GithubRepos/Group_06/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/andre/Documents/GithubRepos/Group_06/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useContext,useEffect,useState}from\"react\";import axios from\"axios\";import{APIpaths}from\"../API\";import useLocalStorage from\"../hooks/useLocalStorage\";var CartContext=React.createContext();export function useCart(){return useContext(CartContext);}export function CartProvider(_ref){var children=_ref.children;var _useLocalStorage=useLocalStorage(\"cart-items\",[]),_useLocalStorage2=_slicedToArray(_useLocalStorage,2),cartItems=_useLocalStorage2[0],setCartItems=_useLocalStorage2[1];var _useState=useState(true),_useState2=_slicedToArray(_useState,2),loading=_useState2[0],setLoading=_useState2[1];var subTotal=cartItems.reduce(function(accumulator,current){return accumulator+current.qty*current.price;},0);var taxCost=subTotal*0.13;var shippingCost=subTotal>50?0:20;var totalCost=subTotal+taxCost+shippingCost;function addToCart(_x){return _addToCart.apply(this,arguments);}function _addToCart(){_addToCart=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(productId){var existingItem,product;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:existingItem=cartItems.find(function(item){return item._id===productId;});if(!existingItem){_context.next=5;break;}setCartItems(cartItems.map(function(item){return item._id===productId?_objectSpread(_objectSpread({},existingItem),{},{qty:existingItem.qty+1}):item;}));_context.next=16;break;case 5:_context.prev=5;_context.next=8;return axios.get(\"\".concat(APIpaths.getOneItem).concat(productId));case 8:product=_context.sent;setCartItems([].concat(_toConsumableArray(cartItems),[_objectSpread(_objectSpread({},product.data),{},{qty:1})]));setLoading(false);_context.next=16;break;case 13:_context.prev=13;_context.t0=_context[\"catch\"](5);return _context.abrupt(\"return\");case 16:case\"end\":return _context.stop();}}},_callee,null,[[5,13]]);}));return _addToCart.apply(this,arguments);}function removeFromCart(productId){var existingItem=cartItems.find(function(item){return item._id===productId;});if(existingItem.qty===1){setCartItems(cartItems.filter(function(item){return item._id!==productId;}));}else{setCartItems(cartItems.map(function(item){return item._id===productId?_objectSpread(_objectSpread({},existingItem),{},{qty:existingItem.qty-1}):item;}));}}function clearCart(){setCartItems([]);}useEffect(function(){setCartItems(cartItems);setLoading(false);},[cartItems,setCartItems]);var value={cartItems:cartItems,subTotal:subTotal,taxCost:taxCost,shippingCost:shippingCost,totalCost:totalCost,addToCart:addToCart,removeFromCart:removeFromCart,clearCart:clearCart};return/*#__PURE__*/React.createElement(CartContext.Provider,{value:value},!loading&&children);}","map":{"version":3,"sources":["/home/andre/Documents/GithubRepos/Group_06/client/src/contexts/CartContext.js"],"names":["React","useContext","useEffect","useState","axios","APIpaths","useLocalStorage","CartContext","createContext","useCart","CartProvider","children","cartItems","setCartItems","loading","setLoading","subTotal","reduce","accumulator","current","qty","price","taxCost","shippingCost","totalCost","addToCart","productId","existingItem","find","item","_id","map","get","getOneItem","product","data","removeFromCart","filter","clearCart","value"],"mappings":"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","sourcesContent":["import React, { useContext, useEffect, useState } from \"react\";\nimport axios from \"axios\";\nimport { APIpaths } from \"../API\";\nimport useLocalStorage from \"../hooks/useLocalStorage\";\n\nconst CartContext = React.createContext();\n\nexport function useCart() {\n  return useContext(CartContext);\n}\n\nexport function CartProvider({ children }) {\n  const [cartItems, setCartItems] = useLocalStorage(\"cart-items\", []);\n  const [loading, setLoading] = useState(true);\n\n  const subTotal = cartItems.reduce(\n    (accumulator, current) => accumulator + current.qty * current.price,\n    0\n  );\n  const taxCost = subTotal * 0.13;\n  const shippingCost = subTotal > 50 ? 0 : 20;\n  const totalCost = subTotal + taxCost + shippingCost;\n\n  async function addToCart(productId) {\n    const existingItem = cartItems.find((item) => item._id === productId);\n\n    if (existingItem) {\n      setCartItems(\n        cartItems.map((item) =>\n          item._id === productId\n            ? { ...existingItem, qty: existingItem.qty + 1 }\n            : item\n        )\n      );\n    } else {\n      try {\n        const product = await axios.get(`${APIpaths.getOneItem}${productId}`);\n        setCartItems([...cartItems, { ...product.data, qty: 1 }]);\n        setLoading(false);\n      } catch (error) {\n        return;\n      }\n    }\n  }\n\n  function removeFromCart(productId) {\n    const existingItem = cartItems.find((item) => item._id === productId);\n\n    if (existingItem.qty === 1) {\n      setCartItems(cartItems.filter((item) => item._id !== productId));\n    } else {\n      setCartItems(\n        cartItems.map((item) =>\n          item._id === productId\n            ? { ...existingItem, qty: existingItem.qty - 1 }\n            : item\n        )\n      );\n    }\n  }\n\n  function clearCart() {\n    setCartItems([]);\n  }\n\n  useEffect(() => {\n    setCartItems(cartItems);\n    setLoading(false);\n  }, [cartItems, setCartItems]);\n\n  const value = {\n    cartItems,\n    subTotal,\n    taxCost,\n    shippingCost,\n    totalCost,\n    addToCart,\n    removeFromCart,\n    clearCart,\n  };\n\n  return (\n    <CartContext.Provider value={value}>\n      {!loading && children}\n    </CartContext.Provider>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}